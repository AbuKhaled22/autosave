---
import { Image } from 'astro:assets';
import PageLayout from '../../layouts/PageLayout.astro';
import { getLocalizedPath } from '../../lib/i18n';

const lang = 'en' as const;
const carImages = Array.from({ length: 21 }, (_, index) => {
  const order = String(index + 1).padStart(2, '0');
  return {
    src: `/images/car-served/car-served-${order}.jpeg`,
    alt: `Served car at our authorized maintenance center number ${index + 1}`,
  };
});
---

<PageLayout
  title="Authorized maintenance center | AUTO SAVE"
  description="Explore our authorized maintenance center with a premium dynamic car showcase that changes every 2 seconds and a complete modern gallery of served vehicles."
  lang={lang}
>
  <section class="relative overflow-hidden hero-gradient text-[#f0ebe0]">
    <div class="hero-pattern"></div>
    <div class="relative z-10 mx-auto max-w-7xl px-4 py-20 lg:px-8 lg:py-28">
      <header class="max-w-3xl">
        <span class="hero-animate eyebrow-decorated text-sm font-semibold uppercase tracking-widest text-primary">AUTO SAVE Authorized Facility</span>
        <h1 class="hero-animate hero-animate-delay-1 mt-4 text-4xl font-bold tracking-tight font-display sm:text-5xl">Authorized maintenance center for Car Service</h1>
        <p class="hero-animate hero-animate-delay-2 mt-6 text-base leading-relaxed text-[#f0ebe0]/65 sm:text-lg">
          We deliver trusted automotive support with maintenance centers options, certified technicians, and professional service quality from inspection to final delivery.
        </p>
      </header>
    </div>
  </section>

  <section class="py-20 lg:py-28">
    <div class="container mx-auto px-4">
      <div class="grid gap-8 lg:grid-cols-[1.25fr_0.75fr] lg:items-start">
        <article class="rounded-2xl border border-border bg-card p-3 shadow-sm sm:p-4" data-animate="fade-in-up">
          <header class="mb-4 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
            <h2 class="text-2xl font-bold tracking-tight font-display sm:text-3xl">Live Car Showcase Screen</h2>
            <span class="inline-flex items-center rounded-full bg-primary/10 px-3 py-1 text-xs font-semibold text-primary">Auto-switches every 2 seconds</span>
          </header>
          <div class="installment-slider-screen relative aspect-[16/10] overflow-hidden rounded-xl border border-border bg-secondary/40" style={`--slide-count:${carImages.length};`}>
            {carImages.map((image, index) => (
              <figure class="installment-slide" style={`--slide-index:${index};`}>
                <Image
                  src={image.src}
                  alt={image.alt}
                  width={1600}
                  height={1000}
                  class="h-full w-full object-cover"
                  loading={index === 0 ? 'eager' : 'lazy'}
                  fetchpriority={index === 0 ? 'high' : 'auto'}
                />
              </figure>
            ))}
          </div>
        </article>

        <aside class="rounded-2xl border border-border bg-card p-6 shadow-sm" data-animate="fade-in-up" data-animate-delay="100">
          <h2 class="text-2xl font-bold tracking-tight font-display">Why our maintenance centers?</h2>
          <ul class="mt-5 space-y-4 text-sm text-muted-foreground sm:text-base">
            <li class="rounded-lg bg-secondary/60 p-4">Certified technicians with hands-on experience across multiple vehicle categories.</li>
            <li class="rounded-lg bg-secondary/60 p-4">Clear  workflow from booking to final handover.</li>
            <li class="rounded-lg bg-secondary/60 p-4">Professional follow-up and practical recommendations to keep your car performing well.</li>
          </ul>
          <a
            href={getLocalizedPath('/contact', lang)}
            aria-label="Go to AUTO SAVE contact page"
            class="mt-6 inline-flex min-h-11 items-center justify-center rounded-lg gold-gradient gold-shimmer px-6 py-3 text-sm font-semibold text-white shadow-md transition hover:shadow-lg hover:shadow-primary/20"
          >
            Book Your Consultation
          </a>
        </aside>
      </div>
    </div>
  </section>

  <section class="bg-secondary/40 py-20 lg:py-28">
    <div class="container mx-auto px-4">
      <header class="mb-10 text-center" data-animate="fade-in-up">
        <h2 class="text-3xl font-bold tracking-tight font-display sm:text-4xl">Served Cars Gallery</h2>
        <p class="mx-auto mt-4 max-w-2xl text-base leading-relaxed text-muted-foreground sm:text-lg">
          A complete visual gallery of some cars served at our authorized maintenance center.
        </p>
      </header>

      <ul id="gallery-grid" class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
        {carImages.map((image, index) => (
          <li class:list={[index >= 6 && 'gallery-hidden-item hidden']} data-animate="fade-in-up" data-animate-delay={String(((index % 6) + 1) * 100)}>
            <article class="card-hover-lift overflow-hidden rounded-xl border border-border bg-card shadow-sm">
              <figure>
                <Image
                  src={image.src}
                  alt={image.alt}
                  width={800}
                  height={600}
                  class="h-56 w-full object-cover"
                  loading="lazy"
                />
                <figcaption class="border-t border-border px-4 py-3 text-sm font-medium text-foreground">
                  Served car #{index + 1}
                </figcaption>
              </figure>
            </article>
          </li>
        ))}
      </ul>

      <div class="mt-10 flex justify-center">
        <button
          id="load-more-btn"
          type="button"
          aria-label="Load more gallery images"
          class="inline-flex min-h-11 min-w-44 items-center justify-center gap-2 rounded-lg border border-primary bg-primary/10 px-8 py-3 text-sm font-semibold text-primary transition hover:bg-primary/20 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary disabled:cursor-not-allowed disabled:opacity-60"
        >
          <svg id="load-more-spinner" class="hidden h-5 w-5 animate-spin" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          <span id="load-more-text">Load More</span>
        </button>
      </div>
    </div>
  </section>

  <script>
    const btn = document.getElementById('load-more-btn') as HTMLButtonElement | null;
    const spinner = document.getElementById('load-more-spinner');
    const text = document.getElementById('load-more-text');
    const defaultLabel = 'Load More';
    const loadingLabel = 'Loading...';

    btn?.addEventListener('click', () => {
      if (btn.disabled) return;
      btn.disabled = true;
      spinner?.classList.remove('hidden');
      if (text) text.textContent = loadingLabel;

      setTimeout(() => {
        document.querySelectorAll('.gallery-hidden-item').forEach((item) => {
          item.classList.remove('hidden', 'gallery-hidden-item');
        });
        spinner?.classList.add('hidden');
        if (text) text.textContent = defaultLabel;
        btn.disabled = false;
      }, 10000);
    });
  </script>
</PageLayout>
